
<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="theme-color" content="#2a7a64">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("service-worker.js");
      });
    }
  </script>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>Heart-Healthy Dinners & Grocery List</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f7f9fb;
      color: #333;
      max-width: 800px;
      margin: auto;
      padding: 2rem;
    }
    h1, h2 {
      color: #2a7a64;
    }
    .meal, .grocery {
      background: #ffffff;
      border: 1px solid #d6e0e6;
      border-radius: 6px;
      padding: 1rem;
      margin-bottom: 1.5rem;
    }
    .grocery {
      background: #e8f5f0;
    }
    .instructions {
      display: none;
      margin-top: 1rem;
    }
    .toggle-btn {
      background: none;
      color: #2a7a64;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      text-decoration: underline;
      padding: 0;
    }
  
    .remove-btn {
      margin-left: 1rem;
      background-color: #a94442;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 0.2rem 0.5rem;
      cursor: pointer;
    }
    .remove-btn:hover {
      background-color: #922d2b;
    }
    .swap-btn {
      padding: 0.4rem 0.8rem;
      background-color: #e67e22;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-left: 1rem;
    }
    .swap-btn:hover {
      background-color: #d35400;
    }
    .swap-btn:disabled {
      background-color: #bdc3c7;
      cursor: not-allowed;
    }
    .loading {
      opacity: 0.6;
    }
    input[type="text"] {
      padding: 0.4rem;
      margin-top: 1rem;
      margin-right: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      width: 70%;
    }
    button {
      padding: 0.4rem 0.8rem;
      background-color: #2a7a64;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #256c58;
    }
    
    @media (max-width: 600px) {
      body {
        padding: 1rem;
      }
      input[type="text"] {
        width: 100%;
        margin-bottom: 0.5rem;
      }
      button {
        width: 100%;
        margin-top: 0.3rem;
      }
      li {
        flex-direction: column;
        align-items: flex-start;
      }
      .remove-btn {
        margin: 0.3rem 0 0 0;
      }
    }
    </style>


</head>
<body>

  <h1>5 Heart-Healthy Dinners (No Fish or Onions)</h1>

  <div id="api-config" style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 1rem; margin-bottom: 1rem; border-radius: 6px;">
    <h3>Claude API Configuration</h3>
    <input type="password" id="claude-api-key" placeholder="Enter your Claude API key..." style="width: 70%; margin-right: 0.5rem;">
    <button onclick="saveApiKey()">Save Key</button>
    <p style="font-size: 0.9em; color: #666; margin-top: 0.5rem;">Your API key is stored locally and never sent to our servers.</p>
  </div>

  <div class="meal" data-meal-id="0">
    <h2>Grilled Lemon Herb Chicken</h2>
    <button class="toggle-btn" onclick="toggleInstructions(this)">View Instructions</button>
    <button class="swap-btn" onclick="swapRecipe(this)" style="margin-left: 1rem; background-color: #e67e22;">Swap Recipe</button>
    <div class="instructions">
      <ol>
        <li>Marinate chicken with lemon juice, garlic, herbs, olive oil, salt and pepper for 30 minutes.</li>
        <li>Grill on medium-high heat for 6â€“7 minutes per side until cooked through.</li>
        <li>Cook quinoa in low-sodium broth as per package instructions.</li>
        <li>Steam broccoli and toss with lemon zest and olive oil before serving.</li>
      </ol>
    </div>
  </div>

  <div class="meal" data-meal-id="1">
    <h2>Stuffed Bell Peppers with Turkey</h2>
    <button class="toggle-btn" onclick="toggleInstructions(this)">View Instructions</button>
    <button class="swap-btn" onclick="swapRecipe(this)" style="margin-left: 1rem; background-color: #e67e22;">Swap Recipe</button>
    <div class="instructions">
      <ol>
        <li>Preheat oven to 375Â°F (190Â°C).</li>
        <li>SautÃ© turkey with garlic and tomatoes, mix with cooked brown rice.</li>
        <li>Stuff mixture into halved bell peppers, top with a bit of cheese.</li>
        <li>Bake for 25â€“30 minutes until peppers are tender.</li>
      </ol>
    </div>
  </div>

  <div class="meal" data-meal-id="2">
    <h2>Lentil and Sweet Potato Stew</h2>
    <button class="toggle-btn" onclick="toggleInstructions(this)">View Instructions</button>
    <button class="swap-btn" onclick="swapRecipe(this)" style="margin-left: 1rem; background-color: #e67e22;">Swap Recipe</button>
    <div class="instructions">
      <ol>
        <li>SautÃ© diced celery and carrots for 5 minutes.</li>
        <li>Add sweet potatoes, lentils, and seasonings. Cover with water or broth.</li>
        <li>Simmer for 25â€“30 minutes until lentils are soft.</li>
        <li>Serve with whole grain bread.</li>
      </ol>
    </div>
  </div>

  <div class="meal" data-meal-id="3">
    <h2>Whole Wheat Pasta with Vegetables</h2>
    <button class="toggle-btn" onclick="toggleInstructions(this)">View Instructions</button>
    <button class="swap-btn" onclick="swapRecipe(this)" style="margin-left: 1rem; background-color: #e67e22;">Swap Recipe</button>
    <div class="instructions">
      <ol>
        <li>Cook whole wheat pasta as directed.</li>
        <li>SautÃ© mushrooms, spinach, garlic, and tomatoes in olive oil.</li>
        <li>Combine with drained pasta and sprinkle with fresh basil.</li>
      </ol>
    </div>
  </div>

  <div class="meal" data-meal-id="4">
    <h2>Chickpea & Avocado Tacos</h2>
    <button class="toggle-btn" onclick="toggleInstructions(this)">View Instructions</button>
    <button class="swap-btn" onclick="swapRecipe(this)" style="margin-left: 1rem; background-color: #e67e22;">Swap Recipe</button>
    <div class="instructions">
      <ol>
        <li>Mash chickpeas with avocado, cumin, lime juice, salt and pepper.</li>
        <li>Prepare cabbage slaw with shredded cabbage, carrots, lime juice.</li>
        <li>Fill whole grain tortillas with chickpea mix and slaw.</li>
      </ol>
    </div>
  </div>

  <h2>ðŸ›’ Grocery List</h2>
  
<div class="grocery">
  <ul id="grocery-list">
    <li><label><input type="checkbox"> Skinless chicken breasts</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Lemons</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Garlic</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Fresh herbs</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Quinoa</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Broccoli</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Red and yellow bell peppers</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Ground turkey</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Brown rice</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Diced tomatoes</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Reduced-fat cheese</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Lentils</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Sweet potatoes</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Carrots</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Celery</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Whole grain bread</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Whole wheat pasta</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Spinach</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Mushrooms</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Cherry tomatoes</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Avocados</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Chickpeas</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Whole grain tortillas</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Red cabbage</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Cumin, chili powder, smoked paprika</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Olive oil</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
    <li><label><input type="checkbox"> Lime</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button></li>
  </ul>
  <div>
    <input type="text" id="new-item" placeholder="Add grocery item...">
    <button onclick="addItem()">Add</button>
  </div>

  </div>

  <script>
    function toggleInstructions(button) {
      const div = button.nextElementSibling;
      div.style.display = div.style.display === "block" ? "none" : "block";
    }
  
    function addItem() {
      const input = document.getElementById('new-item');
      const value = input.value.trim();
      if (value) {
        const li = document.createElement('li');
        li.innerHTML = `<label><input type="checkbox"> ${value}</label><button class="remove-btn" onclick="removeItem(this)">âœ•</button>`;
        document.getElementById('grocery-list').appendChild(li);
        input.value = '';
      }
    }

    function removeItem(button) {
      const li = button.parentElement;
      li.remove();
    }

    // Claude API integration
    let claudeApiKey = localStorage.getItem('claude-api-key');

    function saveApiKey() {
      const keyInput = document.getElementById('claude-api-key');
      claudeApiKey = keyInput.value.trim();
      if (claudeApiKey) {
        localStorage.setItem('claude-api-key', claudeApiKey);
        keyInput.value = '';
        alert('API key saved successfully!');
      }
    }

    // Load saved API key on page load
    window.addEventListener('load', () => {
      if (claudeApiKey) {
        document.getElementById('api-config').style.display = 'none';
      }
    });

    async function swapRecipe(button) {
      if (!claudeApiKey) {
        alert('Please configure your Claude API key first.');
        document.getElementById('api-config').style.display = 'block';
        return;
      }

      const mealDiv = button.closest('.meal');
      const mealId = mealDiv.dataset.mealId;
      const currentTitle = mealDiv.querySelector('h2').textContent;
      
      // Disable button and show loading state
      button.disabled = true;
      button.textContent = 'Generating...';
      mealDiv.classList.add('loading');

      try {
        const newRecipe = await callClaudeAPI(currentTitle);
        updateRecipe(mealDiv, newRecipe);
        updateShoppingList();
      } catch (error) {
        console.error('Error swapping recipe:', error);
        alert('Failed to generate new recipe. Please try again.');
      } finally {
        // Re-enable button
        button.disabled = false;
        button.textContent = 'Swap Recipe';
        mealDiv.classList.remove('loading');
      }
    }

    async function callClaudeAPI(currentRecipe) {
      const prompt = `Please provide a heart-healthy dinner recipe that replaces "${currentRecipe}". The recipe should:
      - Be heart-healthy and nutritious
      - Avoid fish and onions
      - Include a catchy title
      - Have 4-6 step-by-step instructions
      - List all ingredients needed

      Format your response as JSON:
      {
        "title": "Recipe Name",
        "instructions": ["Step 1", "Step 2", ...],
        "ingredients": ["ingredient 1", "ingredient 2", ...]
      }`;

      const response = await fetch('https://api.anthropic.com/v1/messages', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-api-key': claudeApiKey,
          'anthropic-version': '2023-06-01'
        },
        body: JSON.stringify({
          model: 'claude-3-sonnet-20240229',
          max_tokens: 1000,
          messages: [{
            role: 'user',
            content: prompt
          }]
        })
      });

      if (!response.ok) {
        throw new Error(`API call failed: ${response.status}`);
      }

      const data = await response.json();
      const content = data.content[0].text;
      
      // Extract JSON from the response
      const jsonMatch = content.match(/\{[\s\S]*\}/);
      if (!jsonMatch) {
        throw new Error('Could not parse recipe from API response');
      }
      
      return JSON.parse(jsonMatch[0]);
    }

    function updateRecipe(mealDiv, recipe) {
      // Update title
      mealDiv.querySelector('h2').textContent = recipe.title;
      
      // Update instructions
      const instructionsDiv = mealDiv.querySelector('.instructions ol');
      instructionsDiv.innerHTML = '';
      recipe.instructions.forEach(instruction => {
        const li = document.createElement('li');
        li.textContent = instruction;
        instructionsDiv.appendChild(li);
      });
    }

    function updateShoppingList() {
      // Get all current recipes and their ingredients
      const meals = document.querySelectorAll('.meal');
      const allIngredients = new Set();
      
      meals.forEach(meal => {
        const instructions = meal.querySelector('.instructions ol');
        if (instructions) {
          // Extract ingredients from instructions (simplified approach)
          const text = instructions.textContent.toLowerCase();
          
          // Common ingredients to look for
          const commonIngredients = [
            'chicken', 'turkey', 'beef', 'pork', 'lentils', 'chickpeas', 'beans',
            'rice', 'quinoa', 'pasta', 'bread', 'tortillas',
            'tomatoes', 'peppers', 'broccoli', 'spinach', 'carrots', 'celery',
            'potatoes', 'sweet potatoes', 'avocado', 'mushrooms', 'cabbage',
            'garlic', 'herbs', 'olive oil', 'cheese', 'lemon', 'lime'
          ];
          
          commonIngredients.forEach(ingredient => {
            if (text.includes(ingredient)) {
              allIngredients.add(ingredient);
            }
          });
        }
      });
      
      // Note: For a complete implementation, you'd want to call Claude API again
      // to generate a proper shopping list based on all current recipes
      console.log('Updated ingredients needed:', Array.from(allIngredients));
    }
    </script>


</body>
</html>
